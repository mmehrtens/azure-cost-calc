<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Azure Backup Cost Calculation</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href=".\water.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Azure Backup Cost Calculation</h1>
</header>
<h2 id="general-parameters">General Parameters</h2>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 8%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Unit</th>
<th style="text-align: right;">Default</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(P_{veeam}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">50%</td>
<td style="text-align: left;">Veeam Data Reduction (in percent
subtracted from original volume)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(P_{azure}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">0%</td>
<td style="text-align: left;">Azure Data Reduction (in percent
subtracted from original volume)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(\Delta_{daily}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">3.0%</td>
<td style="text-align: left;">Daily change rate (average for all
workloads)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\beta_{veeam}\)</span></td>
<td style="text-align: center;">kB</td>
<td style="text-align: right;">1024 kB</td>
<td style="text-align: left;">Veeam blocksize (read at source)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(\psi_{worker}\)</span></td>
<td style="text-align: center;">MB/s</td>
<td style="text-align: right;">90 MB/s</td>
<td style="text-align: left;">Maximum throughput of a single Veeam
worker (depends on worker VM size: 90, 180 or 270 MB/s)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\psi_{stacc}\)</span></td>
<td style="text-align: center;">MB/s</td>
<td style="text-align: right;">3200 MB/s</td>
<td style="text-align: left;">Maximum throughput of a single Azure blob
storage account (25 or 60 Gb/s <span
class="math inline">\(\implies\)</span> 3200 or 7680 MB/s)</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="azure-cost-parameters">Azure Cost Parameters</h3>
<p>These depend on chosen region, VM size, storage tier, reserved
vs. pay-as-you-go, etc., and should be selectable from Azure cost
tables. The given defaults are just examples from <em>WestEurope</em>
region.</p>
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 17%" />
<col style="width: 15%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: right;">Default</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(D_{azure}\)</span></td>
<td style="text-align: left;">%</td>
<td style="text-align: right;"><span
class="math inline">\(0\%\)</span></td>
<td style="text-align: left;">Azure discount percentage</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{storage}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;"><em>(hot RA-GRS payg)</em> 0.04900 $</td>
<td style="text-align: left;">Azure blob storage (used as Veeam backup
target) cost per GB per month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{vault}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;"><em>(RA-GRS)</em> 0.05696 $</td>
<td style="text-align: left;">Azure backup vault (used as Azure backup
target) cost per GB per month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{vm}\)</span></td>
<td style="text-align: left;">$ per hour</td>
<td style="text-align: right;"><em>(Std_F4s_v2 payg)</em> 0.22700 $</td>
<td style="text-align: left;">Azure VM cost per hour</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{snap}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;">0.13020 $</td>
<td style="text-align: left;">Azure <strong>VM snapshot</strong> cost
per GB per month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backupsnap}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;">0.14500 $</td>
<td style="text-align: left;">Azure <strong>backup snapshot</strong>
cost per GB per month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{put}\)</span></td>
<td style="text-align: left;">$ per <span
class="math inline">\(10,000\)</span></td>
<td style="text-align: right;"><em>(hot tier)</em> 0.10800 $</td>
<td style="text-align: left;">Cost of <span
class="math inline">\(10,000\)</span> Azure API <em>put</em> calls</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backup(small)}\)</span></td>
<td style="text-align: left;">$ per VM</td>
<td style="text-align: right;">5 $</td>
<td style="text-align: left;">Monthly cost of Azure backup service per
VM of provisioned size <span
class="math inline">\(&lt;50\)</span> GB</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backup(medium)}\)</span></td>
<td style="text-align: left;">$ per VM</td>
<td style="text-align: right;">10 $</td>
<td style="text-align: left;">Monthly cost of Azure backup service per
VM of provisioned size <span class="math inline">\(\geq50\)</span> GB
and <span class="math inline">\(&lt;500\)</span> GB</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backup(addon)}\)</span></td>
<td style="text-align: left;">$ per VM per <span
class="math inline">\(500\)</span> GB</td>
<td style="text-align: right;">10 $</td>
<td style="text-align: left;">Monthly add-on cost in steps of <span
class="math inline">\(500\)</span> GB for Azure backup service per VM of
provisioned size <span class="math inline">\(\geq500\)</span> GB</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="veeam-cost-parameters">Veeam Cost Parameters</h3>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 15%" />
<col style="width: 6%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Constant</th>
<th style="text-align: center;">Unit</th>
<th style="text-align: right;">Default</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(D_{veeam}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">30%</td>
<td style="text-align: left;">Veeam discount percentage</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{veeam}^{list}\)</span></td>
<td style="text-align: center;">$ per VM per month</td>
<td style="text-align: right;">10.85 $</td>
<td style="text-align: left;">VUL list price (<span
class="math inline">\(=1.302,00\)</span> $ per <span
class="math inline">\(10\)</span> VMs per year)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{veeam}^{real} = C_{veeam}^{list} \cdot ( 1 -
D_{veeam})\)</span></td>
<td style="text-align: center;">$ per VM per month</td>
<td style="text-align: right;">7.60 $</td>
<td style="text-align: left;">Real (i.e. discounted) VUL cost per VM per
month</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="main-input-variables">Main Input variables</h2>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 44%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Unit</th>
<th style="text-align: left;">Description</th>
<th>Constraints</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(N_{vm}^{small}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Number of small VMs <span
class="math inline">\(&lt;50\)</span> GB</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(N_{vm}^{medium}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Number of medium VMs <span
class="math inline">\(\geq50\)</span> GB and <span
class="math inline">\(&lt;500\)</span> GB</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(N_{vm}^{large}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Number of large VMs <span
class="math inline">\(\geq500\)</span> GB</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(N_{vm}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Total number of VMs to be protected</td>
<td><span
class="math inline">\(=N_{vm}^{small}+N_{vm}^{medium}+N_{vm}^{large}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(V_{vm}\)</span></td>
<td style="text-align: center;">GB</td>
<td style="text-align: left;">Average provisoned size of VMs to be
protected</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(U_{vm}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: left;">Average disk utilization of protected
VMs</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(T_{incr}\)</span></td>
<td style="text-align: center;">hours</td>
<td style="text-align: left;">Time window for incremental backups</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(R_{days}\)</span></td>
<td style="text-align: center;">days</td>
<td style="text-align: left;">Retention</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(N_{snaps}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Number of daily snapshots to be kept</td>
<td>must be <span class="math inline">\(\geq2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\delta_{isfull}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Does first Azure native snapshot require
full (used) size ?</td>
<td><span class="math inline">\(1=\)</span> yes | <span
class="math inline">\(0=\)</span> no</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="calculation-formulas">Calculation Formulas</h2>
<h3 id="general">General</h3>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 15%" />
<col style="width: 6%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th>Value</th>
<th style="text-align: right;"></th>
<th style="text-align: center;"></th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Total provisioned source volume of workloads in TB (all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{prov}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(\big(N_{vm}\cdot V_{vm}\big)\div
1024\)</span></td>
</tr>
<tr class="even">
<td>Total used source volume (average) of workloads in TB (all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{used}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(V_{prov}\cdot U_{vm}\)</span></td>
</tr>
<tr class="odd">
<td>Total snapshot volume in TB (if <span
class="math inline">\(\delta_{isfull}=0\)</span>)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{snaps}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(V_{used}\cdot\Delta_{daily}\cdot
N_{snaps}\)</span></td>
</tr>
<tr class="even">
<td>Total snapshot volume in TB (if <span
class="math inline">\(\delta_{isfull}=1\)</span>)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{snaps}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span
class="math inline">\(\Big(V_{used}\cdot\Delta_{daily}\cdot(N_{snaps}-1)\Big)+V_{used}\)</span></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="veeam-backup">Veeam Backup</h3>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 15%" />
<col style="width: 6%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th>Value</th>
<th style="text-align: right;"></th>
<th style="text-align: center;"></th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Volume of full backups in TB (all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{veeam}^{full}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\((1-P_{veeam})\cdot
V_{used}\)</span></td>
</tr>
<tr class="even">
<td>Volume of incremental backups in TB (all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{veeam}^{incr}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span
class="math inline">\(V_{veeam}^{full}\cdot\Delta_{daily}\)</span></td>
</tr>
<tr class="odd">
<td>Total backup volume in TB for retention of <span
class="math inline">\(r\)</span> days (no GFS, all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{veeam}^{total}(r)\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(V_{veeam}^{full}+ \big(V_{veeam}^{incr}
\cdot(r-1)\big)\)</span></td>
</tr>
<tr class="even">
<td>Throughput required for incremental backup in MB/s</td>
<td style="text-align: right;"><span
class="math inline">\(\Phi_{incr}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(\big(V_{veeam}^{incr}\cdot
1024^2\big)\div\big(T_{incr}\cdot 3600\big)\)</span></td>
</tr>
<tr class="odd">
<td>Veeam workers required for incremental backup<br/><span
class="math inline">\(\quad\)</span>rounded up to full integer</td>
<td style="text-align: right;"><span
class="math inline">\(N_{workers}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span
class="math inline">\(\Phi_{incr}\div\psi_{worker}\)</span></td>
</tr>
<tr class="even">
<td>Estimated number of API <em>put</em> calls within given <span
class="math inline">\(r\)</span> days<br/><span
class="math inline">\(\quad\)</span> incrementals only</td>
<td style="text-align: right;"><span
class="math inline">\(A_{put}(r)\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\((r\cdot V_{veeam}^{incr}\cdot
1024^3)\div\beta_{veeam}\)</span></td>
</tr>
<tr class="odd">
<td>Maximum number of Veeam workers per storage account in
MB/s<br/><span class="math inline">\(\quad\)</span> rounded up to full
integer, based on storage account limit given as <span
class="math inline">\(\psi_{stacc}\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(N_{workers_{max}}(\psi_{stacc})\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span
class="math inline">\(\psi_{stacc}\div\psi_{worker}\)</span></td>
</tr>
<tr class="even">
<td>Number of storage accounts required in MB/s<br/><span
class="math inline">\(\quad\)</span> rounded up to full integer, based
on storage account limit given as <span
class="math inline">\(\psi_{stacc}\)</span></td>
<td style="text-align: right;"><span
class="math inline">\(N_{stacc}(\psi_{stacc})\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span
class="math inline">\(\textrm{max}\Big((\Phi_{incr}\div\psi_{stacc}),(N_{workers}\div
N_{workers_{max}})\Big)\)</span></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="azure-backup">Azure Backup</h3>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 15%" />
<col style="width: 6%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th>Value</th>
<th style="text-align: right;"></th>
<th style="text-align: center;"></th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Volume of full backups in TB (all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{azure}^{full}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\((1-P_{azure})\cdot
V_{used}\)</span></td>
</tr>
<tr class="even">
<td>Volume of incremental backups in TB (all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{azure}^{incr}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span
class="math inline">\(V_{azure}^{full}\cdot\Delta_{daily}\)</span></td>
</tr>
<tr class="odd">
<td>Total backup volume in TB for retention of <span
class="math inline">\(r\)</span> days (no GFS, all VMs)</td>
<td style="text-align: right;"><span
class="math inline">\(V_{azure}^{total}(r)\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(V_{azure}^{full}+ \big(V_{azure}^{incr}
\cdot(r-1)\big)\)</span></td>
</tr>
<tr class="even">
<td>Cost of Azure Backup service for all small VMs <span
class="math inline">\(&lt;50\)</span> GB</td>
<td style="text-align: right;"><span
class="math inline">\(C_{azure}^{small}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(N_{vm}^{small}\cdot
C_{azure}^{backup(small)}\)</span></td>
</tr>
<tr class="odd">
<td>Cost of Azure Backup service for all medium VMs <span
class="math inline">\(\geq50\)</span> GB and <span
class="math inline">\(&lt;500\)</span> GB</td>
<td style="text-align: right;"><span
class="math inline">\(C_{azure}^{medium}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(N_{vm}^{medium}\cdot
C_{azure}^{backup(medium)}\)</span></td>
</tr>
<tr class="even">
<td>Cost of Azure Backup service for all large VMs <span
class="math inline">\(\geq500\)</span> GB</td>
<td style="text-align: right;"><span
class="math inline">\(C_{azure}^{large}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(N_{vm}^{large}\cdot
C_{azure}^{backup(large)}\)</span></td>
</tr>
<tr class="odd">
<td>Total cost of Azure Backup service for all VMs</td>
<td style="text-align: right;"><span
class="math inline">\(C_{azure}^{total}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span
class="math inline">\(C_{azure}^{small}+C_{azure}^{medium}+C_{azure}^{large}\)</span></td>
</tr>
<tr class="even">
<td>Monthly total cost of Azure backup vault storage for all VMs with
retention of <span class="math inline">\(r\)</span> days</td>
<td style="text-align: right;"><span
class="math inline">\(C_{azurevault}^{total}(r)\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(=\)</span></td>
<td><span class="math inline">\(V_{azure}^{total}(r)\cdot
C_{azure}^{vault}\cdot 1024\)</span></td>
</tr>
</tbody>
</table>
</body>
</html>
