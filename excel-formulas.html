<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Azure Backup Cost Calculation</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href=".\water.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Azure Backup Cost Calculation</h1>
</header>
<h2 id="general-parameters">General Parameters</h2>
<table style="width:98%;">
<colgroup>
<col style="width: 20%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Unit</th>
<th style="text-align: right;">Default</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(P_{veeam}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">50%</td>
<td style="text-align: left;">Veeam Data Reduction (in percent
subtracted from original volume)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(P_{azure}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">0%</td>
<td style="text-align: left;">Azure Data Reduction ( in percent
subtracted from original volume)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(\Delta_{daily}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">3.0%</td>
<td style="text-align: left;">Daily change rate (all workloads)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\beta_{veeam}\)</span></td>
<td style="text-align: center;">kB</td>
<td style="text-align: right;">1024 kB</td>
<td style="text-align: left;">Veeam blocksize (read at source)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(\psi_{worker}\)</span></td>
<td style="text-align: center;">MB/s</td>
<td style="text-align: right;">90 MB/s</td>
<td style="text-align: left;">Maximum throughput of a single Veeam
worker (depends on worker VM size: 90, 180 or 270 MB/s)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(\psi_{stacc}\)</span></td>
<td style="text-align: center;">MB/s</td>
<td style="text-align: right;">3200 MB/s</td>
<td style="text-align: left;">Maximum throughput of a single Azure blob
storage account (25 or 60 Gb/s <span
class="math inline">\(\implies\)</span> 3200 or 7680 MB/s)</td>
</tr>
</tbody>
</table>
<h3 id="azure-cost-parameters">Azure Cost Parameters</h3>
<p>These depend on chosen region, VM size, storage tier, reserved
vs. pay-as-you-go, etc., and should be selectable from Azure cost
tables. The given defaults are just examples from <em>WestEurope</em>
region.</p>
<table style="width:98%;">
<colgroup>
<col style="width: 27%" />
<col style="width: 16%" />
<col style="width: 13%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: right;">Default</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(D_{azure}\)</span></td>
<td style="text-align: left;">%</td>
<td style="text-align: right;"><span
class="math inline">\(0\%\)</span></td>
<td style="text-align: left;">Azure discount percentage</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{storage}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;"><em>(hot RA-GRS payg)</em> 0.04900 $</td>
<td style="text-align: left;">Azure blob storage (used as Veeam backup
target) cost per GB per month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{vault}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;"><em>(RA-GRS)</em> 0.05696 $</td>
<td style="text-align: left;">Azure backup vault (used as Azure backup
target) cost per GB per month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{vm}\)</span></td>
<td style="text-align: left;">$ per hour</td>
<td style="text-align: right;"><em>(Std_F4s_v2 payg)</em> 0.22700 $</td>
<td style="text-align: left;">Azure VM cost per hour</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{snap}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;">0.13020 $</td>
<td style="text-align: left;">Azure <strong>VM snapshot</strong> cost
per GB per month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backupsnap}\)</span></td>
<td style="text-align: left;">$ per GB per month</td>
<td style="text-align: right;">0.14500 $</td>
<td style="text-align: left;">Azure <strong>backup snapshot</strong>
cost per GB per month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{put}\)</span></td>
<td style="text-align: left;">$ per 10,000</td>
<td style="text-align: right;"><em>(hot tier)</em> 0.10800 $</td>
<td style="text-align: left;">Cost of 10,000 Azure API <em>put</em>
calls</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backup(small)}\)</span></td>
<td style="text-align: left;">$ per VM (&lt;50 GB)</td>
<td style="text-align: right;">5 $</td>
<td style="text-align: left;">Monthly cost of Azure backup service per
VM of provisioned size &lt;50 GB</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backup(medium)}\)</span></td>
<td style="text-align: left;">$ per VM (&gt;50 GB and &lt; 500 GB)</td>
<td style="text-align: right;">10 $</td>
<td style="text-align: left;">Monthly cost of Azure backup service per
VM of provisioned size between 50 GB and 500 GB</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{azure}^{backup(addon)}\)</span></td>
<td style="text-align: left;">$ per VM per 500 GB</td>
<td style="text-align: right;">10 $</td>
<td style="text-align: left;">Monthly add-on cost in steps of 500 GB for
Azure backup service per VM of provisioned size &gt;500 GB</td>
</tr>
</tbody>
</table>
<p>This allows us to calculate the total (non-discounted) monthly cost
of the Azure backup service for a single <em>large</em> VM with
provisioned size given as <span class="math inline">\(V_{vm}\)</span>
(&gt;500 GB)</p>
<blockquote>
<p><span
class="math inline">\(C_{azure}^{backup(large)}(V_{vm})=C_{azure}^{backup(medium)}+\Big(C_{azure}^{backup(addon)}\cdot(\textrm{roundup}\Big({\frac{V_{vm}}{\textrm{500
GB}}}\Big)-1)\Big)\)</span></p>
</blockquote>
<h3 id="veeam-cost-parameters">Veeam Cost Parameters</h3>
<table style="width:99%;">
<colgroup>
<col style="width: 45%" />
<col style="width: 9%" />
<col style="width: 7%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Constant</th>
<th style="text-align: center;">Unit</th>
<th style="text-align: right;">Default</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(D_{veeam}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: right;">30%</td>
<td style="text-align: left;">Veeam discount percentage</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(C_{veeam}^{list}\)</span></td>
<td style="text-align: center;">$ per VM per month</td>
<td style="text-align: right;">10.85 $</td>
<td style="text-align: left;">VUL list price (1.302,00 $ per 10 VMs per
year)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(C_{veeam}^{real} = C_{veeam}^{list} \cdot ( 1 -
D_{veeam})\)</span></td>
<td style="text-align: center;">$ per VM per month</td>
<td style="text-align: right;">7.60 $</td>
<td style="text-align: left;">discounted VUL cost</td>
</tr>
</tbody>
</table>
<h2 id="main-input-variables">Main Input variables</h2>
<table style="width:98%;">
<colgroup>
<col style="width: 23%" />
<col style="width: 9%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Unit</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(N_{vm}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Number of native Azure VMs to protect</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(V_{vm}\)</span></td>
<td style="text-align: center;">GB</td>
<td style="text-align: left;">Average provisoned size of VMs to be
protected</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(U_{vm}\)</span></td>
<td style="text-align: center;">%</td>
<td style="text-align: left;">Average Disk utilization of protected
VMs</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(T_{incr}\)</span></td>
<td style="text-align: center;">hours</td>
<td style="text-align: left;">Time window for incremental backups</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(R_{days}\)</span></td>
<td style="text-align: center;">days</td>
<td style="text-align: left;">Retention</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span
class="math inline">\(N_{snaps}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">Number of daily snapshots to be kept (must
be <span class="math inline">\(\geq1\)</span>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span
class="math inline">\(\delta_{isfull}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">does first Azure native snapshot require
full occupied size ? (<span class="math inline">\(1=yes; 0=
no\)</span>)</td>
</tr>
</tbody>
</table>
<h2 id="calculation-formulas">Calculation Formulas</h2>
<h3 id="veeam">Veeam</h3>
<p>Total provisioned source volume of workloads in TB:<br />
<span class="math inline">\(\quad V_{prov}=\big(N_{vm}\cdot
V_{vm}\big)\div 1024\)</span></p>
<p>Total used source volume of workloads in TB:<br />
<span class="math inline">\(\quad V_{used}=V_{prov}\cdot
U_{vm}\)</span></p>
<p>Volume of a single incremental backup in TB:<br />
<span class="math inline">\(\quad V_{incr}=(1-P_{veeam})\cdot
V_{used}\cdot\Delta_{daily}\)</span></p>
<p>Total backup volume in TB (<span class="math inline">\(=\)</span>
single full backup plus <span
class="math inline">\((R_{days}-1)\)</span> incremental backups):<br />
<span class="math inline">\(\quad
V_{total}=\Big(1-P_{veeam}\Big)\cdot\Big(V_{used}+\big((V_{used}\cdot\Delta_{daily})\cdot(R_{days}-1)\big)\Big)\)</span></p>
<p>Total snapshot volume in TB (if <span
class="math inline">\(\delta_{isfull}=0\)</span>):<br />
<span class="math inline">\(\quad
V_{snaps}=V_{used}\cdot\Delta_{daily}\cdot N_{snaps}\)</span></p>
<p>Total snapshot volume [TB] (if <span
class="math inline">\(\delta_{isfull}=1\)</span>):<br />
<span class="math inline">\(\quad
V_{snaps}=\Big(V_{used}\cdot\Delta_{daily}\cdot(N_{snaps}-1)\Big)+V_{used}\)</span></p>
<p>Throughput required for incremental backup in MB/s:<br />
<span class="math inline">\(\quad\Phi_{incr}=\big(V_{incr}\cdot
1024^2\big)\div\big(T_{incr}\cdot 3600\big)\)</span></p>
<p>Veeam workers required for incremental backup (rounded up to full
integer):<br />
<span class="math inline">\(\quad
N_{workers}=\Phi_{incr}\div\psi_{worker}\)</span></p>
<p>Estimated number of API <em>put</em> calls within given <span
class="math inline">\(days\)</span> (incrementals only):<br />
<span class="math inline">\(\quad
A_{put}(days)=\big(days\cdot\Delta_{daily}\cdot V_{used}\cdot
1024^3\big)\div\beta_{veeam}\)</span></p>
<p>Maximum number of Veeam workers per storage account (rounded up to
integer), based on storage account limit given as <span
class="math inline">\(\psi\)</span> in MB/s:<br />
<span class="math inline">\(\quad
N_{workers_{max}}(\psi_{stacc})=\psi_{stacc}\div\psi_{worker}\)</span></p>
<p>Number of storage accounts required (rounded up to integer), based on
storage account limit given as <span class="math inline">\(\psi\)</span>
in MB/s:<br />
<span class="math inline">\(\quad
N_{stacc}(\psi_{stacc})=\textrm{max}\Big((\Phi_{incr}\div\psi_{stacc}),(N_{workers}\div
N_{workers_{max}})\Big)\)</span></p>
</body>
</html>
